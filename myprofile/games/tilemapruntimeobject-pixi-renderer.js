var gdjs;(function(a){class f{constructor(t,e){this._lastCullingLeftBound=0;this._lastCullingRightBound=0;this._lastCullingTopBound=0;this._lastCullingBottomBound=0;this._object=t,PIXI.tilemap.settings.use32bitIndex=!0,this._pixiObject=new PIXI.tilemap.CompositeTilemap,this._pixiObject.tileAnim=[0,0],e.getLayer("").getRenderer().addRendererObject(this._pixiObject,t.getZOrder()),this.updateAngle(),this.updateOpacity(),this.updatePosition()}getRendererObject(){return this._pixiObject}incrementAnimationFrameX(t){this._pixiObject.tileAnim[0]+=1}updatePosition(){this._pixiObject.pivot.x=this._object.getTileMapWidth()/2,this._pixiObject.pivot.y=this._object.getTileMapHeight()/2,this._pixiObject.position.x=this._object.x+this.getWidth()/2,this._pixiObject.position.y=this._object.y+this.getHeight()/2}updateAngle(){this._pixiObject.rotation=a.toRad(this._object.angle)}updateOpacity(){const t=this._object._opacity/255;if(this._pixiObject.alpha===t)return;this._pixiObject.alpha=t;const e=this._object.getTileMap();if(!!e){for(const i of e.getLayers())this._object._displayMode==="index"&&this._object._layerIndex!==i.id||this._object._displayMode==="visible"&&!i.isVisible()||i instanceof TileMapHelper.EditableTileMapLayer&&i.setAlpha(this._pixiObject.alpha);this._object.updateTileMap(!0)}}setWidth(t){this._pixiObject.scale.x=t/this._object.getTileMapWidth(),this._pixiObject.position.x=this._object.x+t/2}setHeight(t){this._pixiObject.scale.y=t/this._object.getTileMapHeight(),this._pixiObject.position.y=this._object.y+t/2}setScaleX(t){this._pixiObject.scale.x=t;const e=t*this._object.getTileMapWidth();this._pixiObject.position.x=this._object.x+e/2}setScaleY(t){this._pixiObject.scale.y=t;const e=t*this._object.getTileMapHeight();this._pixiObject.position.y=this._object.y+e/2}getWidth(){return this._object.getTileMapWidth()*this._pixiObject.scale.x}getHeight(){return this._object.getTileMapHeight()*this._pixiObject.scale.y}getScaleX(){return this._pixiObject.scale.x}getScaleY(){return this._pixiObject.scale.y}refreshPixiTileMap(t,e){const i=this._object,o=i.getTileMap();if(!o)return;const g=o.getDimensionX(),_=o.getDimensionY();let n=0,l=g,c=0,p=_;const m=this._object.getInstanceContainer(),d=m.getScene(),j=this._object.getLayer(),s=this._object.getInstanceContainer().getLayer(j);if(g+_>100&&R(i)&&m===d&&(!a.scene3d||a.scene3d.camera.getCameraRotationX(d,j,0)===0&&a.scene3d.camera.getCameraRotationY(d,j,0)===0)){const u=s.getCameraX(),x=s.getCameraY();let r=s.getCameraWidth()/2,h=s.getCameraHeight()/2;if(s.getCameraRotation()!==0){const y=r+h;r=y,h=y}const[O,T]=i.getGridCoordinatesFromSceneCoordinates(u-r,x-h),[M,C]=i.getGridCoordinatesFromSceneCoordinates(u+r,x+h);n=Math.min(O,M),l=Math.max(O,M)+1,c=Math.min(T,C),p=Math.max(T,C)+1}(e||this._lastCullingLeftBound!==n||this._lastCullingRightBound!==l||this._lastCullingTopBound!==c||this._lastCullingBottomBound!==p)&&(this._lastCullingLeftBound=n,this._lastCullingRightBound=l,this._lastCullingTopBound=c,this._lastCullingBottomBound=p,TileMapHelper.PixiTileMapHelper.updatePixiTileMap(this._pixiObject,o,t,this._object._displayMode,this._object._layerIndex,n,l,c,p))}destroy(){this._pixiObject.destroy(!1)}}a.TileMapRuntimeObjectPixiRenderer=f;function R(b){return b.getGridCoordinatesFromSceneCoordinates}a.TileMapRuntimeObjectRenderer=a.TileMapRuntimeObjectPixiRenderer})(gdjs||(gdjs={}));
//# sourceMappingURL=tilemapruntimeobject-pixi-renderer.js.map
